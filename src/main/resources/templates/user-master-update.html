<!DOCTYPE html>
<html lang="en"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorator="layouts/defaultcdac">
  
<body>
   
    <div id="page" layout:fragment="content">
        
               <!--********************************* First Table , For Screen Header**********************************************-->
<table style="width: 980px;border-collapse: collapse;margin:0px; padding:0px;background-color:#ffffff;border-spacing:0px" cellpadding="0" cellspacing="0">
        <tbody>
            <tr>
                <td style="width: 9px;background-image: url(&#39;  /theme/l.gif&#39;);text-align: center"></td>
                <td style="width: 955px;background-image:url(&#39;  /theme/topcellback11.gif&#39;);text-align: center;" colspan="2">
                    <img style="widows: 1px;height: 11px;border: 0px" src="/theme/space.gif">
                    <table style="width: 958px;border-collapse: collapse;margin:0px; padding:0px;border-spacing:0px" cellpadding="0" cellspacing="0">
                        <tbody><tr>
                                <td style="width: 9px" rowspan="4"><img style="width: 9px;height: 40px;display: block" src="/theme/title_01.gif"></td>
                                <td style="vertical-align: top;background-image: url(&#39;  /theme/title_02.gif&#39;)" rowspan="2"></td>
                                <td style="width: 199px;vertical-align:middle" rowspan="4"><img style="width: 199px;height: 40px;display: block" src="/theme/title_03.gif"></td>
                                <td style="width: 144px;background-image: url(&#39;  /theme/title_04.gif&#39;);text-align: right;background-position:center;background-repeat: no-repeat" class="pageHeading" rowspan="4">User Master</td>
                                <td style="width: 221px" colspan="3"><img style="width: 221px;height: 16px;display: block" src="/theme/title_05.gif"></td>
                                <td><img style="width: 1px;height: 16px;display: block" src="/theme/spacer.gif"></td>
                        </tr>
                        <tr>
                            <td style="width: 199px" rowspan="3"><img style="width: 199px;height: 24px;display: block" src="/theme/title_06.gif"></td>
                            <td style="width: 12px" rowspan="2"><img style="width: 12px;height: 13px;display: block" src="/theme/title_07.gif"></td>
                            <td style="width: 10px" rowspan="3"><img style="width: 10px;height: 24px;display: block" src="/theme/title_08.gif"></td>
                            <td style="width: 1px"><img style="width: 1px;height: 1px;display: block" src="/theme/spacer.gif"></td>
                        </tr>
                        <tr>
                            <td style="background-image: url(&#39;  /theme/title_09.gif&#39;);text-align: left" rowspan="2" class="navigation"><a href="/" class="link4">Home</a> &gt;&gt;User Master</td>
                            <td style="width: 1px"><img style="width: 1px;height: 12px;display: block" src="/theme/spacer.gif"></td>
                        </tr>
                        <tr>
                            <td style="width: 12px"><img style="width: 12px;height: 11px;display: block" src="/theme/title_10.gif"></td>
                            <td style="width: 1px"><img style="width: 1px;height: 11px;display: block" src="/theme/spacer.gif"></td>
                        </tr>
                    </tbody>
                  </table>
                </td>
                <td style="width: 10px;background-image: url(&#39;  /theme/r.gif&#39;);text-align: center"></td>
            </tr>
        </tbody>
        </table>
<!--********************************* Second Table, For Error Messages **********************************************-->


<table border="0" cellpadding="0" cellspacing="0" width="980">
    <tbody><tr>
        <td align="center" background="theme/l.gif" width="9"></td>
        <td width="5"><img src="/theme/space.gif" border="0" height="10" width="1"></td>
        <td width="950">
            <div id="errorMessage" class="errcolor" th:text="${message}"></div>            
        </td>
        <td align="center" background="theme/r.gif" width="10"></td>
    </tr>
</tbody></table>
 
         <table border="0" cellpadding="0" cellspacing="0" width="980">
            <tbody><tr>
                <td align="center" background="theme/l.gif" width="9"></td>
                <td width="5"><img src="/theme/space.gif" border="0" height="10" width="1"></td>
                <td colspan="2" style="text-align: right">
                                                                
                                                                

<div id="qualReportAuthDiv" style="display: none;height: auto;padding : 0px 0px 0px 0px;" align="left"></div>
                                                                   
                                                            </td>
                <td align="center" background="theme/r.gif" width="10"></td>
            </tr>
        </tbody></table>
        <script type="text/javascript">
   
    $(document).ready(function() {
                    setTimeout( removeMessage, 10000 ); 
                   
                      debugger;
                    
                    var t = $('#user').DataTable({bSort : false,searching: false, paging: false, info: false});
                    
                    var itemCounter=t.rows().count()-5;
                    var i=itemCounter+1;
                    console.log(itemCounter);
                            var counter = 1;
                        $('#addRow').on( 'click', function () {
                            debugger;
                            itemCounter++;
                             var i=itemCounter+1;
                          var row=    t.row.add( [
                              i+" Authority User",
                        " <input type='hidden' name='employeeAuthorityLevelList["+itemCounter+"].authorityLevel' value="+itemCounter+" >"
                                +" <select name='employeeAuthorityLevelList["+itemCounter+"].authorizedEmployee.userId' id='nextAuthority"+itemCounter+"' style='width:200px'  >"
                                                                      +"<option value='0'>Select</option>"
                                                                     
                                                                   +"</select>",
                                                           " <a  href='#'  class='btn btn-xs btn-default '><span id='remove_"+counter+"' class='glyphicon glyphicon-minus-sign remove'></span> </a>",
                                                           "",
                                                           ""
                            
                      
                            ] ).draw( false );


                          
                            
                            
                            
                            $(row).addClass("left-align");
                            counter++;
                           
                             getUserList(itemCounter); 
                        } );
                            //  $('#addRow').click();  
                              $("#submit").click(function(event){
        debugger;
  event.preventDefault();
  var userName=$("#userName").val().trim();
     if(userName=="")
     {
         $("#errorMessage").html("user name can not be empty.")
         return;
     }
     var userEmployeeId=$("#userEmployeeId").val().trim();
     if(userEmployeeId=="")
     {
         $("#errorMessage").html("user Employee Id can not be empty.")
         return;
     }
       var userId=$("#userId").val().trim();
     if(userId=="")
     {
         $("#errorMessage").html("Error.")
         return;
     }
     var userEmail=$("#userEmail").val().trim();
     if(userEmail=="")
     {
         $("#errorMessage").html("user user Email can not be empty.")
         return;
     }
     var userContactNo=$("#userContactNo").val().trim();
     if(userContactNo=="")
     {
         $("#errorMessage").html("user mobile number can not be empty.")
         return;
     }
     
        $("#frmEntrySlip").submit();
});
        $(document).on('click','.remove',function(e) {
  //handler code here
    event.preventDefault();
    var totalCount=t.rows().count();
                                  debugger;
                                  
                                  
                                 var selectedrow= $(this).closest("tr");
                                var selectedrowIndex= selectedrow.index();
                                 t.row( selectedrow ).remove().draw();
                                 
                                 
                                 
                                  
                                  console.log(row);
   });
                              
    
} );
function getUserList(sno)
              {
                  $.get('/masters/users/', function(data) 
                                 {
                                     
                                            if (data.length === 0)
                                            {
                                            $("#errorMessageJs").html("No User Found ");
                                            } else{
                                                    $("#errorMessageJs").html("");
                                                    $("#purchasetype"+sno).html("");
                                                    var option = "";
                                                    data.forEach(function(user, i) {
                                                    debugger;
                                                    option = option + "<option value = " + user.userId + ">" +user.userId+" :: "+ user.userName + "</option>";
                                                    });
                                                    $("#nextAuthority"+sno).append(option);
                                            }
                                    });  
              }
     function removeMessage()
              {
                   $("#errorMessage").html("");
              }
     </script>
<form name="frmEntrySlip" id="frmEntrySlip" method="post" th:object="${user}"    th:action="@{/masters/users/update}" >


   
<!-- Include File To Display Header and Menu -->        

<table style="width: 980px;text-align: left;" cellspacing="0" cellpadding="0">
<tbody> 
    <tr>
        <td style="width:8px;background-image: url(&#39;  /theme/l.gif&#39;);text-align:left"><img style="width: 1px;height: 1px;border-width: 0px;display: block" src="/theme/space.gif"></td>
        <td style="width: 962px">
            <table style="widows: 960px;border-width: 0px;background-color:#ffffff" cellpadding="0" cellspacing="0">
            <tbody>
                <tr>
                    <td style="width: 100%;vertical-align: top;">
                        <div >
                        <table  style="width: 960px;border-width: 0px;background-color:#ffffff;text-align: center;" id="tblAdvanceApp" cellpadding="0" cellspacing="0">
                            <tbody>
                                <tr>
                                    <td style="width: 8px"><img style="width: 8px;height: 23px;border-width: 0px;display: block" src="/theme/6_l.gif" alt=""></td>
                                    <!-- *** Update Table Header -->
                                    <td style="background-image: url(&#39;  /theme/6_m.gif&#39;);" nowrap="nowrap" class="heading">&nbsp;Update User:</td>
                                    <td style="width: 8px;background-image: url(&#39;  /theme/6_m.gif&#39;);" nowrap="nowrap"></td>
                                    <td style="width: 100%;background-image: url(&#39;  /theme/6_m.gif&#39;);">
                                        <table style="width: 100%;border-width: 0px;"  cellspacing="0" cellpadding="0">
                                            <tbody><tr>
                                                <td style="width: 85%"></td>
                                                <td style="width: 15%;text-align: right">
                                                    <span id="spcol" onclick="ToggleTable3(&#39;trRow1&#39;,&#39;trRow2&#39;,&#39;trRow3&#39;,&#39;spexp&#39;,&#39;spcol&#39;,&#39;C&#39;); return false; " style="cursor: pointer"><img style="width: 13px;height: 13px;border-width: 0px;" src="/theme/ico_collapse.gif" id="imgcol" alt="Collapse"></span>
                                                    <span id="spexp" onclick="ToggleTable3(&#39;trRow1&#39;,&#39;trRow2&#39;,&#39;trRow3&#39;,&#39;spexp&#39;,&#39;spcol&#39;,&#39;E&#39;); return false;" style="cursor: pointer; display: none;"><img style="width: 13px;height: 13px;border-width: 0px;" src="/theme/ico_expand.gif" id="imgexp" alt="Expand"></span>
                                                </td>
                                            </tr>
                                        </tbody></table>
                                    </td>
                                    <td><img style="width: 10px;height: 23px;border-width: 0px;display: block;" src="/theme/6_r.gif" alt=""></td>
                                </tr>
                                <tr id="trRow1">
                                    <td style="width: 1px;height: 1px;background-image: url(&#39;  /theme/l.gif&#39;)"><img style="width: 1px;height: 1px;border-width: 0px;" src="/theme/space.gif"></td>
                                    <td colspan="3">
                                        <img style="width: 1px;height: 10px;border-width: 0px;display: block;" src="/theme/space.gif">
                                        
                                        <table style="width: 100%;border-width: 0" id="tdataTable" cellpadding="0" cellspacing="0" >
                                           
                                        <tbody>
                                            <tr>
                                                <td bgcolor="#dbeaf5">
                                                    <!--*************Starting of Data Table*******************-->
                                                    <table id="user" width="100%" border="0" cellpadding="4" cellspacing="1" style="padding: 0px 0px 0px 0px;">
                                                        <thead>
                                                <tr>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                    
                                                    
                                                </tr>
                                            </thead>
                                                        
                                                        <tbody><tr class="row2">
                                                            <td width="20%">
                                                                Employee Name <font color="#CC0000"> *</font>
                                                            </td>
                                                            <td> 
                                                                <input name="user.userName" th:field="${userWrapper.user.userName}" maxlength="250" id="userName" type="text" class="textbox" style="width:150px" value="">
                                                                 <input name="user.userId" th:field="${userWrapper.user.userId}" maxlength="250" id="userId" type="hidden" class="textbox" style="width:150px" value="">
                                                                
                                                              
                                                               
                                                            </td>
                                                            <td></td>
                                                            <td></td>
                                                            
                                                            
                                                            
                                                        </tr>
                                                        
                                                        <tr class="row1">
                                                            <td>Employee Id	 <input th:field="${userWrapper.user.userEmployeeId}" name="user.userEmail" maxlength="250" id="userEmployeeId" type="hidden" class="textbox" style="width:150px" value="">
                                                                <input th:field="${userWrapper.user.userId}" name="user.userEmail" maxlength="6" id="userId" type="hidden" class="textbox" style="width:150px" value="">
                                                               	 <font color="#CC0000"> *</font></td>
                                                            <td colspan="1" th:text="${userWrapper.user.userEmployeeId}">
                                                                
                                                            </td>
                                                            <td >
                                                                    User Type
                                                               </td> 
                                                               <td >
                                                                    <select name='user.userType' id='roleName' style="width:150px"  >
                                                                     
                                                                     <option th:each="userType : ${userTypeList}" th:value="${userType.roleId}" th:text="${userType.roleName}" th:selected="${userType.roleId==userWrapper.user.userType}"></option>
       
                                                                </select>
                                                                </td>
                                                            </tr>
                                                            <tr class="row2">
                                                                 <td>Email Id<font color="#CC0000"> *</font></td>
                                                            <td>
                                                               
                                                                 <input th:field="${userWrapper.user.userEmail}" name="user.userEmail" maxlength="250" id="userEmail" type="text" class="textbox" style="width:150px" value="">
                                                              </td>
                                                                <td>Mobile Number<font color="red">*</font></td>
                                                                <td>
                                                                     <input th:field="${userWrapper.user.userContactNo}" name="user.userContactNo" maxlength="10" id="userContactNo" type="number" class="textbox" style="width:150px" value="">
                                                                </td>
                                                            </tr>
                                                             <tr class="row1">
                                                                <td >
                                                                   Department
                                                               </td> 
                                                               <td >
                                                                    <select name='user.department.departmentId' id='roleName' style="width:200px"  >
                                                                      <option value="0">Select</option>

                                                                     <option th:each="obj : ${departmentList}" th:value="${obj.departmentId}" th:text="${obj.departmentName}" th:selected="${ obj.departmentId==userWrapper.user.department?.departmentId}"></option>
       
                                                                </select>
                                                                </td>
                                                               
                                                               <td >
                                                                   Designation
                                                               </td> 
                                                               <td >
                                                                    <select name='user.designation.designationId' id='roleName' style="width:200px"  >
                                                                      <option value="0">Select</option>

                                                                      <option th:each="obj : ${designationList}" th:value="${obj.designationId}" th:text="${obj.designationName}" th:selected="${ obj.designationId==userWrapper.user.designation?.designationId}"></option>
       
                                                                </select>
                                                                </td>
                                                            </tr>
                                                            
                                                            
                                                            <tr class="row1">
                                                                <td >
                                                                  1 Authority User
                                                               </td> 
                                                               <td >
                                                                   <input type="hidden" name="employeeAuthorityLevelList[0].authorityLevel" value="1" th:field="${userWrapper.employeeAuthorityLevelList[0].authorityLevel}">
                                                                    <select name='employeeAuthorityLevelList[0].authorizedEmployee.userId' id='roleName' style="width:200px"  >
                                                                      <option value="0">Select</option>

                                                                      <option th:each="userObj : ${userList}" 
                                                                              th:value="${userObj.userId}" 
                                                                              th:text="${userObj.userEmployeeId}+' :: '+${userObj.userName}"
                                                                              th:selected="${userWrapper?.employeeAuthorityLevelList!=null and !userWrapper?.employeeAuthorityLevelList?.empty and userObj.userId==userWrapper?.employeeAuthorityLevelList[0]?.authorizedEmployee?.userId}"
                                                                              ></option>
       <!-- th:selected="${userWrapper.employeeAuthorityLevelList!=null and !user.employeeAuthorityLevelList.empty and userObj.userId==userWrapper.employeeAuthorityLevelList[0].employee.userId}"-->
                                                                </select>
                                                                </td>
                                                               
                                                              <td style="float: right;"  id="addRow"><a href="#" class="btn btn-xs btn-default">Add next level authority<span class="glyphicon glyphicon-plus"></span> </a></td>
                                                                                       
                                                              <td></td>
                                                            </tr>
                                                        <th:block th:each="dindent,iter : ${userWrapper.employeeAuthorityLevelList}">
                                                            
                                                            
                                                            <tr class="row1" th:if="${iter.index>0}">
                                                                <td th:text="${iter.index+1}+' Authority User'">
                                                                
                                                               </td> 
                                                               <td >
                                                                   
                                         <input type="hidden" name="employeeAuthorityLevelList[0].authorityLevel" th:value="${iter.index+1}" th:field="${userWrapper.employeeAuthorityLevelList[0].authorityLevel}">
                                                                   
                                                           
                                                                    <select th:name="'employeeAuthorityLevelList['+${iter.index}+'].authorizedEmployee.userId'" th:id="'nextAuthority'+${iter.index}" style="width:200px"  >
                                                                      <option value="0">Select</option>

                                                                      <option th:each="userObj : ${userList}" 
                                                                              th:value="${userObj.userId}" 
                                                                              th:text="${userObj.userEmployeeId}+' :: '+${userObj.userName}"
                                                                              th:selected="${userWrapper.employeeAuthorityLevelList!=null and !userWrapper.employeeAuthorityLevelList.empty and userObj.userId==userWrapper.employeeAuthorityLevelList[iter.index]?.authorizedEmployee?.userId}"
                                                                              ></option>
       <!--    -->
                                                                </select>
                                                                </td>
                                                                <td> <a  href='#'  class='btn btn-xs btn-default '><span th:id="'remove_'+${iter.index}" class='glyphicon glyphicon-minus-sign remove'></span> </a></td>
                                                                                       
                                                              <td></td>
                                                            </tr>
                                                        </th:block>
                                                           
                                                    </tbody></table>
                                                    <script>
                                                        
                                                    </script>
                                                    <!--************End of Data Table********************-->
                                                </td>
                                            </tr>
                                        </tbody>
                                        </table>
                                        
                                        <img style="width: 1px;height: 10px;border-width: 0px;display: block;" src="/theme/space.gif">
                                    </td>
                                    <td style="background-image: url(&#39;  /theme/r.gif&#39;)"><img style="width: 1px;height: 1px;display: block;" src="/theme/space.gif"></td>
                                </tr>
                                <tr id="trRow2"><td style="background-color: #4682b4;" colspan="5"><img style="width: 1px;height: 1px;border-width: 0px;display: block;" src="/theme/space.gif"></td></tr>
                                <tr id="trRow3">
                                <td colspan="5" align="right">
                                    
                                    <input type="image" border="0" height="22" width="79" src="/theme/send.gif" id="submit">
                                      
                                    <input type="image" src="/theme/cancel.gif" border="0" height="22" width="79" id="cancel" >
                                </td>
                            </tr>
                            </tbody>
                            </table>
                        </div>
                            <table border="0" cellpadding="0" cellspacing="0" width="960">
                                <tbody><tr>
                                    <td align="center" width="9"></td>
                                    <td width="5"></td>
                                    <td width="950" style="text-align: right">
                                     </td>
                                    <td align="center" width="10"></td>
                                </tr>
                            </tbody></table>
                            
                            <img style="width: 1px;height: 5px;border-width: 0px;" src="/theme/space.gif">                            


 <div th:replace="user-list :: user-list"></div>

            <img style="width: 1px;height: 10px;border-width: 0px;" src="/theme/space.gif"><br>
            <img style="width: 1px;height: 10px;border-width: 0px;" src="/theme/space.gif">
    </td>
    <td style="width: 10px;background-image: url(&#39;  /theme/r.gif&#39;);background-position: center;background-repeat: repeat-y;">
        <img style="width: 10px;height: 10px;border-width: 0px;display: block;" src="/theme/space.gif">
    </td>
</tr>
</tbody>
</table>
 <table style="width: 980px;background-color: #ffffff;border-width: 0px;" cellpadding="0" cellspacing="0">
<tbody>
    <tr>
        <td style="width:8px;height: 23px;background-image: url(&#39;  /theme/2_m.gif&#39;);background-repeat: no-repeat;"><img style="width: 8px;height: 23px;border-width: 0px;" src="/theme/8_l.gif" alt=""></td>
        <td style="height: 23px;background-image: url(&#39;  /theme/2_m1.gif&#39;);display: block;text-align:center;"><font color="#000000" size="2">Powered by e-Governance solutions Group, C-DAC Pune [PV 1.0.1]</font></td>
        <td style="width: 8px;height: 23px;background-image: url(&#39;  /theme/2_m.gif&#39;);background-repeat: no-repeat;"><img style="width: 8px;height: 23px;border-width: 0px;" src="/theme/8_r.gif" alt=""></td>
    </tr>
</tbody>
</table>
</td></tr>
</tbody></table>
</form><canvas id="netbeans_glasspane"  style="position: fixed; top: 0px; left: 0px; z-index: 50000; pointer-events: none;" width="1686" height="820"></canvas>

<script>
    setTimeout('setFocusCaste()',100);
</script>


           </div>

        
        
   
    
            
</body>
</html>